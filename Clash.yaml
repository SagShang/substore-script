# Created by SagShang
# Sub-Store 生成的 Clash 分流配置：定义代理分组、规则提供器与最终路由规则。

x-templates:
  # proxy-groups templates
  group_select_base: &tpl_group_select_base {type: 'select'}
  group_probe_base: &tpl_group_probe_base {url: 'https://cp.cloudflare.com/generate_204'}
  group_urltest_base: &tpl_group_urltest_base {<<: *tpl_group_probe_base, type: 'url-test', interval: 600, tolerance: 50}
  group_fallback_base: &tpl_group_fallback_base {<<: *tpl_group_probe_base, type: 'fallback'}
  group_manual_select: &tpl_group_manual_select {<<: *tpl_group_select_base, proxies: ['♻️ 自动切换', '🔯 故障转移', '🇭🇰 香港', '🇹🇼 台湾', '🇰🇷 韩国', '🇯🇵 日本', '🇸🇬 新加坡', '🇺🇲 美国', '🇬🇧 英国', '🇩🇪 德国', '🌍 全球自选', 'DIRECT']}
  group_failover_fallback: &tpl_group_failover_fallback {<<: *tpl_group_fallback_base, proxies: ['🇭🇰 香港', '🇯🇵 日本', '🇸🇬 新加坡', '🇺🇲 美国'], interval: 600}
  group_select_full: &tpl_group_select_full {<<: *tpl_group_select_base, proxies: ['🚀 手动选择', '♻️ 自动切换', '🔯 故障转移', '🇭🇰 香港', '🇹🇼 台湾', '🇰🇷 韩国', '🇯🇵 日本', '🇸🇬 新加坡', '🇺🇲 美国', '🇬🇧 英国', '🇩🇪 德国', '🌍 全球自选', 'DIRECT']}
  group_select_direct_first: &tpl_group_select_direct_first {<<: *tpl_group_select_base, proxies: ['DIRECT', '🚀 手动选择', '♻️ 自动切换', '🔯 故障转移', '🇭🇰 香港', '🇹🇼 台湾', '🇰🇷 韩国', '🇯🇵 日本', '🇸🇬 新加坡', '🇺🇲 美国', '🇬🇧 英国', '🇩🇪 德国', '🌍 全球自选']}
  group_auto_urltest: &tpl_group_auto_urltest {<<: *tpl_group_urltest_base, proxies: ['🇭🇰 香港', '🇹🇼 台湾', '🇰🇷 韩国', '🇯🇵 日本', '🇸🇬 新加坡', '🇺🇲 美国', '🇬🇧 英国', '🇩🇪 德国', '🌍 全球自选']}
  group_region_urltest: &tpl_group_region_urltest {<<: *tpl_group_urltest_base, include-all: true, hidden: true}

  # rule-providers templates
  provider_http_base: &tpl_provider_http_base {type: 'http', interval: 86400, behavior: 'classical'}
  provider_http_yaml: &tpl_provider_http_yaml {<<: *tpl_provider_http_base, format: 'yaml'}
  provider_http_text: &tpl_provider_http_text {<<: *tpl_provider_http_base, format: 'text'}

proxy-groups:
  # 基础组
  - {name: '🚀 手动选择', <<: *tpl_group_manual_select}
  - {name: '♻️ 自动切换', <<: *tpl_group_auto_urltest}
  - {name: '🔯 故障转移', <<: *tpl_group_failover_fallback}

  # 规则组
  - {name: '🤖 OpenAI', <<: *tpl_group_select_full}
  - {name: '✨ Gemini', <<: *tpl_group_select_full}
  - {name: '🧠 Claude', <<: *tpl_group_select_full}
  - {name: '🐙 GitHub', <<: *tpl_group_select_full}
  - {name: '🌐 谷歌服务', <<: *tpl_group_select_full}
  - {name: '🍎 苹果服务', <<: *tpl_group_select_direct_first}
  - {name: 'Ⓜ️ 微软服务', <<: *tpl_group_select_direct_first}
  - {name: '☁️ 微软网盘', <<: *tpl_group_select_full}
  - {name: '📲 电报消息', <<: *tpl_group_select_full}
  - {name: '🐦 推特社交', <<: *tpl_group_select_full}
  - {name: '📘 脸书社交', <<: *tpl_group_select_full}
  - {name: '📹 油管视频', <<: *tpl_group_select_full}
  - {name: '🎬 奈飞影视', <<: *tpl_group_select_full}
  - {name: '🏰 迪士尼', <<: *tpl_group_select_full}
  - {name: '🎧 Spotify', <<: *tpl_group_select_full}
  - {name: '🎵 TikTok', <<: *tpl_group_select_full}
  - {name: '🎮 游戏平台', <<: *tpl_group_select_full}
  - {name: '📥 下载工具', <<: *tpl_group_select_direct_first}
  - {name: '🪙 加密货币', <<: *tpl_group_select_full}

  # 地区组
  - {name: '🇭🇰 香港', <<: *tpl_group_region_urltest, filter: '(?i)港|HK|Hong Kong|HongKong|hongkong'}
  - {name: '🇹🇼 台湾', <<: *tpl_group_region_urltest, filter: '(?i)台|TW|Taiwan'}
  - {name: '🇯🇵 日本', <<: *tpl_group_region_urltest, filter: '(?i)日|JP|Japan'}
  - {name: '🇰🇷 韩国', <<: *tpl_group_region_urltest, filter: '(?i)韩|KR|Korea|KOR'}
  - {name: '🇸🇬 新加坡', <<: *tpl_group_region_urltest, filter: '(?i)新加坡|SG|Singapore'}
  - {name: '🇺🇲 美国', <<: *tpl_group_region_urltest, filter: '(?i)美|波特兰|达拉斯|俄勒冈|凤凰城|费利蒙|硅谷|拉斯维加斯|洛杉矶|圣何塞|圣克拉拉|西雅图|芝加哥|US|United States'}
  - {name: '🇬🇧 英国', <<: *tpl_group_region_urltest, filter: '(?i)英|GB|UK|United Kingdom'}
  - {name: '🇩🇪 德国', <<: *tpl_group_region_urltest, filter: '(?i)德|DE|Germany|Frankfurt'}
  - {name: '🌍 全球自选', type: 'select', include-all: true}

  # 兜底组
  - {name: '🎯 全球直连', type: 'select', proxies: ['DIRECT', '🚀 手动选择', '♻️ 自动切换', '🔯 故障转移']}
  - {name: '🐟 漏网之鱼', <<: *tpl_group_select_full}

rule-providers:
  # 1. 基础规则
  Local: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Lan/Lan.yaml', path: './ruleset/Lan.yaml'}
  China: {<<: *tpl_provider_http_text, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/ChinaMax/ChinaMax.list', path: './ruleset/ChinaMax.list'}

  # 2. 业务规则
  OpenAI: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/OpenAI/OpenAI.yaml', path: './ruleset/OpenAI.yaml'}
  Gemini: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Gemini/Gemini.yaml', path: './ruleset/Gemini.yaml'}
  Claude: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Claude/Claude.yaml', path: './ruleset/Claude.yaml'}
  Github: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/GitHub/GitHub.yaml', path: './ruleset/Github.yaml'}
  Apple: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Apple/Apple_Classical.yaml', path: './ruleset/Apple.yaml'}
  Microsoft: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Microsoft/Microsoft.yaml', path: './ruleset/Microsoft.yaml'}
  Google: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Google/Google.yaml', path: './ruleset/Google.yaml'}
  Telegram: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Telegram/Telegram.yaml', path: './ruleset/Telegram.yaml'}
  Twitter: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Twitter/Twitter.yaml', path: './ruleset/Twitter.yaml'}
  Facebook: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Facebook/Facebook.yaml', path: './ruleset/Facebook.yaml'}
  Game: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Game/Game.yaml', path: './ruleset/Game.yaml'}
  GameDownload: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Game/GameDownload/GameDownload.yaml', path: './ruleset/GameDownload.yaml'}
  GameDownloadCN: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Game/GameDownloadCN/GameDownloadCN.yaml', path: './ruleset/GameDownloadCN.yaml'}
  Crypto: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Crypto/Crypto.yaml', path: './ruleset/Crypto.yaml'}
  CryptoCustom: {<<: *tpl_provider_http_yaml, url: 'https://sub.sagshang.com/Cvs8vWRV/api/file/CryptoCustom', path: './ruleset/CryptoCustom.yaml'}
  YouTube: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/YouTube/YouTube.yaml', path: './ruleset/YouTube.yaml'}
  Netflix: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Netflix/Netflix.yaml', path: './ruleset/Netflix.yaml'}
  Disney: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Disney/Disney.yaml', path: './ruleset/Disney.yaml'}
  Spotify: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Spotify/Spotify.yaml', path: './ruleset/Spotify.yaml'}
  TikTok: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/TikTok/TikTok.yaml', path: './ruleset/TikTok.yaml'}
  OneDrive: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/OneDrive/OneDrive.yaml', path: './ruleset/OneDrive.yaml'}
  Download: {<<: *tpl_provider_http_yaml, url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Download/Download.yaml', path: './ruleset/Download.yaml'}

rules:
  - 'RULE-SET,Local,🎯 全球直连'
  - 'RULE-SET,OpenAI,🤖 OpenAI'
  - 'RULE-SET,Gemini,✨ Gemini'
  - 'RULE-SET,Claude,🧠 Claude'
  - 'RULE-SET,Github,🐙 GitHub'
  - 'RULE-SET,OneDrive,☁️ 微软网盘'
  - 'RULE-SET,Download,📥 下载工具'
  - 'RULE-SET,GameDownloadCN,📥 下载工具'
  - 'RULE-SET,GameDownload,📥 下载工具'
  - 'RULE-SET,Game,🎮 游戏平台'
  - 'RULE-SET,CryptoCustom,🪙 加密货币'
  - 'RULE-SET,Crypto,🪙 加密货币'
  - 'RULE-SET,YouTube,📹 油管视频'
  - 'RULE-SET,Netflix,🎬 奈飞影视'
  - 'RULE-SET,Disney,🏰 迪士尼'
  - 'RULE-SET,Spotify,🎧 Spotify'
  - 'RULE-SET,TikTok,🎵 TikTok'
  - 'RULE-SET,Telegram,📲 电报消息'
  - 'RULE-SET,Twitter,🐦 推特社交'
  - 'RULE-SET,Facebook,📘 脸书社交'
  - 'RULE-SET,Microsoft,Ⓜ️ 微软服务'
  - 'RULE-SET,Apple,🍎 苹果服务'
  - 'RULE-SET,Google,🌐 谷歌服务'
  - 'RULE-SET,China,🎯 全球直连'
  - 'MATCH,🐟 漏网之鱼'
